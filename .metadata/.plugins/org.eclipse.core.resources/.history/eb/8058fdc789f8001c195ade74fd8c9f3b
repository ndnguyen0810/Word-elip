package buoi9.bai1;

import java.sql.*;

import javax.swing.*;

public class DanhMuc {

	private String maDM;
	private String tenDM;

	public String getMaDM() {
		return maDM;
	}

	public void setMaDM(String maDM) {
		this.maDM = maDM;
	}

	public String getTenDM() {
		return tenDM;
	}

	public void setTenDM(String tenDM) {
		this.tenDM = tenDM;
	}

	public DanhMuc() {
		super();
		con = ConnectBuoi9_bai1.getConnection();
	}

	public DanhMuc(String maDM, String tenDM) {
		super();
		this.maDM = maDM;
		this.tenDM = tenDM;
	}

	// xu ly

	private Connection con;
	ConnectBuoi9_bai1 MyCon = new ConnectBuoi9_bai1();

	public void insert(DanhMuc d) {
		try {
			String sql = String.format("insert into danhmuc(madm, tendm) values ('%s', '%s')", d.maDM, d.tenDM);

			PreparedStatement s = con.prepareStatement(sql);

			if (s.executeUpdate() > 0) {
				System.out.println("Thêm thành công");
			} else {
				System.out.println("Thêm thất bại");
			}
		} catch (SQLException ex) {
			ex.printStackTrace();
		}
	}

	public void delete(DanhMuc d) {
		try {
			String sql = String.format("delete from danhmuc where madm='%s'", d.maDM);
			PreparedStatement s = con.prepareStatement(sql);
			if (s.executeUpdate() > 0) {
				System.out.println("Xoá thành công");
			} else {
				System.out.println("Xoá thất bại");
			}
		} catch (SQLException ex) {
			ex.printStackTrace();
		}
	}

	public void Update(DanhMuc d) {
		try {
			String sql = String.format("update danhmuc set madm='%s', tendm='%s' where madm=%s'", d.maDM, d.tenDM,
					d.maDM);
			PreparedStatement s = con.prepareStatement(sql);
			if (s.executeUpdate() > 0) {
				System.out.println("Cập nhật thành công");
			} else {
				System.out.println("Cập nhật thất bại");
			}
		} catch (SQLException ex) {
			ex.printStackTrace();
		}
	}

	public void showDM_InCombobox(JComboBox cbb) {
		try {
			ResultSet rs = MyCon.getInfo("select * from danhmuc");
			while (rs.next()) {
				String tenDM = rs.getString("TenDM");
				cbb.addItem(tenDM);
			}
		} catch (SQLException ex) {
			ex.printStackTrace();
		}
	}

}
